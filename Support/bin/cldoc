#!/usr/bin/env perl -w

use strict;

my %map = ( "**", 181, "***", 181, "++",
181, "+++", 181, "//", 181, "///",
181, "1+", 125, "1-", 125, "<", 124, "<=", 124, "=", 124, ">", 124, ">=", 124,
"abort", 344, "abs", 128, "acons", 153, "acos", 128, "acosh", 128,
"add-method", 311, "adjoin", 152, "adjust-array", 163, "adjustable-array-p",
160, "alpha-char-p", 137, "alphanumericp", 137, "alter", 355, "always", 245,
"and", 75, "appending", 246, "apply", 81,
"applyhook", 180, "*applyhook*", 180, "apropos", 230, "apropos-list", 230,
"aref", 159, "arithmetic-error", 346, "arithmetic-error-operands", 346,
"arithmetic-error-operation", 346, "array-dimension", 160,
"array-dimension-limit", 158, "array-dimensions", 160, "array-element-type",
160, "array-has-fill-pointer-p", 162, "array-in-bounds-p", 160, "array-rank",
160, "array-rank-limit", 158, "array-row-major-index", 160,
"array-total-size", 160, "array-total-size-limit", 158, "arrayp", 73, "as",
244, "ash", 131, "asin", 128, "asinh", 128, "assoc", 153, "assoc-if", 153, "assoc-if-not", 153, "atan", 128, "atanh", 128,
"atom", 73, "augment-environment", 102, "bit", 161, "bit-and", 161,
"bit-andc1", 161, "bit-andc2", 161, "bit-eqv", 161, "bit-ior", 161,
"bit-nand", 161, "bit-nor", 161, "bit-not", 161, "bit-orc1", 161, "bit-orc2",
161, "bit-vector-p", 73, "bit-xor", 161, "block", 85, "boole", 131,
"both-case-p", 137, "boundp", 78, "*break-on-signals*", 335, "*break-on-warnings*", 220,
"broadcast-stream-streams", 185, "butlast", 149, "byte", 132, "byte-position",
132, "byte-size", 132, "caaaar", 148, "caaadr", 148, "caaar", 148, "caadar",
148, "caaddr", 148, "caadr", 148, "caar", 148, "cadaar", 148, "cadadr", 148,
"cadar", 148, "caddar", 148, "cadddr", 148, "caddr", 148, "cadr", 148,
"call-arguments-limit", 81, "call-method", 311, "call-next-method", 311,
"car", 148, "case", 84, "catch", 96, "catenate", 353, "cdaaar", 148, "cdaadr", 148, "cdaar", 148, "cdadar", 148, "cdaddr", 148,
"cdadr", 148, "cdar", 148, "cddaar", 148, "cddadr", 148, "cddar", 148,
"cdddar", 148, "cddddr", 148, "cdddr", 148, "cddr", 148, "cdr", 148,
"ceiling", 130, "cell-error", 346, "cell-error-name", 346, "change-class", 311, "char", 165, "char-bit", 140, "char-bits",
138, "char-bits-limit", 136, "char-code", 138, "char-code-limit", 136,
"char-control-bit", 140, "char-downcase", 139, "char-equal", 137, "char-font",
138, "char-font-limit", 136, "char-greaterp", 137, "char-hyper-bit", 140,
"char-int", 139, "char-lessp", 137, "char-meta-bit", 140, "char-name", 139,
"char-not-equal", 137, "char-not-greaterp", 137, "char-not-lessp", 137,
"char-super-bit", 140, "char-upcase", 139, "char/=", 137, "char<", 137,
"char<=", 137, "char=", 137, "char>", 137, "char>=", 137, "character", 139,
"characterp", 73, "choose", 353,
"choose-if", 353, "chunk", 353, "cis", 128, "class-name", 311, "class-of",
311, "clear-input", 195, "close", 185, "clrhash", 155, "code-char", 138,
"coerce", 52, "collect-alist", 354,
"collect-and", 354, "collect-append", 354, "collect-file", 354,
"collect-first", 354, "collect-fn", 354, "collect-hash", 354, "collect-last",
354, "collect-length", 354, "collect-max", 354, "collect-min", 354,
"collect-nconc", 354, "collect-nth", 354, "collect-or", 354, "collect-plist",
354, "collect-sum", 354, "collecting", 246, "collecting-fn", 352, "commonp",
73, "compile", 224, "compile-file", 224, "compile-file-pathname", 211,
"*compile-file-pathname*", 224, "*compile-file-truename*", 224,
"*compile-print*", 224, "*compile-verbose*", 224, "compiled-function-p", 73,
"compiler-macro-function", 101,
"compiler-macroexpand", 101, "compiler-macroexpand-1", 101, "complement", 141,
"complex", 130, "complexp", 73, "compute-applicable-methods", 311,
"compute-restarts", 342, "concatenate", 143, "concatenated-stream-streams",
185, "cond", 84, "condition", 346, "conjugate", 125, "cons", 148, "consp", 73,
"constantp", 180, "continue", 344, "control-error", 346, "copy-alist", 149,
"copy-list", 149, "copy-pprint-dispatch", 259, "copy-readtable", 192,
"copy-seq", 142, "copy-symbol", 110, "copy-tree", 149, "cos", 128, "cosh",
128, "cotruncate", 352, "count-if", 145,
"count-if-not", 145, "counting", 246, "*debug-io*", 183, "*debugger-hook*", 345, "decf", 125, "declaim", 104,
"declaration-information", 102, "declare", 104, "decode-float", 130,
"decode-universal-time", 232, "*default-pathname-defaults*", 214, "defclass",
311, "defgeneric", 311, "define-compiler-macro", 101, "define-condition", 339,
"define-declaration", 102, "define-method-combination", 311,
"define-modify-macro", 80, "define-setf-method", 80, "defmacro", 98,
"defmethod", 311, "defpackage", 118, "defstruct", 170, "deftype", 51, "defun",
66, "defvar", 67, "delete", 144, "delete-duplicates", 144, "delete-file", 216,
"delete-if", 144, "delete-if-not", 144, "delete-package", 118, "denominator",
130, "deposit-field", 132, "describe", 230, "describe-object", 230,
"destructuring-bind", 100, "digit-char", 139, "digit-char-p", 137,
"directory", 218, "directory-namestring", 214, "disassemble", 224,
"division-by-zero", 346, "do*", 88, "do-all-symbols",
118, "do-external-symbols", 118, "do-symbols", 118, "doing", 249, "dolist", 89, "dotimes", 89,
"double-float-epsilon", 134, "double-float-negative-epsilon", 134, "dpb", 132,
"dribble", 230, "echo-stream-input-stream", 185,
"echo-stream-output-stream", 185, "ed", 230, "eighth", 149, "elt", 142,
"encapsulated", 361, "enclose", 102, "encode-universal-time", 232,
"end-of-file", 346, "endp", 149, "enough-namestring", 214,
"ensure-generic-function", 311, "eq", 74, "eql", 74, "equal", 74, "equalp",
74, "error", 346, "*error-output*", 183,
"eval", 180, "eval-when", 68, "evalhook",
180, "*evalhook*", 180, "evenp", 123, "every", 143, "exp", 127, "expand", 353,
"export", 118, "expt", 127, "f", 311, "fboundp", 78, "fdefinition", 78,
"*features*", 233, "ffloor", 130, "fifth", 149, "file-author", 216,
"file-error", 346, "file-error-pathname", 346, "file-length", 216,
"file-namestring", 214, "file-position", 216, "file-string-length", 216,
"file-write-date", 216, "fill", 144, "fill-pointer", 162, "finally", 252,
"find", 145, "find-all-symbols", 118, "find-class", 311, "find-if", 145,
"find-if-not", 145, "find-method", 311, "find-package", 118, "find-restart",
342, "find-symbol", 118, "finish-output", 198, "first", 149, "flet", 83,
"float", 130, "float-digits", 130, "float-precision", 130, "float-radix", 130,
"float-sign", 130, "floating-point-overflow", 346, "floating-point-underflow",
346, "floatp", 73, "floor", 130, "for", 244, "format", 200, "formatter", 258,
"fourth", 149, "funcall", 81, "function", 78, "function-information", 102,
"function-keywords", 311, "function-lambda-expression", 224, "functionp", 73,
"gatherer", 365, "gathering", 365, "gcd", 125, "generator", 364,
"generic-flet", 311, "generic-function", 311, "generic-labels", 311, "gensym",
110, "*gensym-counter*", 110, "gentemp", 110, "get", 108, "get-decoded-time",
232, "get-internal-real-time", 232, "get-internal-run-time", 232,
"get-output-stream-string", 184, "get-properties", 108, "get-setf-method", 80,
"get-setf-method-multiple-value", 80, "get-universal-time", 232, "getf", 108,
"gethash", 155, "go", 91, "graphic-char-p", 137, "handler-bind", 338,
"handler-case", 338, "hash-table-count", 155, "hash-table-p", 155,
"hash-table-rehash-size", 155, "hash-table-rehash-threshold", 155,
"hash-table-size", 155, "hash-table-test", 155, "host-namestring", 214,
"identity", 234, "ignore-errors", 338, "imagpart", 130,
"import", 118, "incf", 125,
"initialize-instance", 311, "initially", 252, "input-stream-p", 185,
"inspect", 230, "int-char", 139, "integer-decode-float", 130,
"integer-length", 131, "integerp", 73, "interactive-stream-p", 185, "intern",
118, "internal-time-units-per-second", 232, "intersection", 152,
"invalid-method-error", 311, "invoke-debugger", 345, "invoke-restart", 342,
"isqrt", 127, "iterate", 351, "keywordp", 110, "lambda-list-keywords", 64,
"lambda-parameters-limit", 64, "last", 149, "latch", 352, "lcm", 125, "ldb",
132, "ldb-test", 132, "ldiff", 149, "least-negative-double-float", 134,
"least-negative-long-float", 134, "least-negative-normalized-double-float",
134, "least-negative-normalized-long-float", 134,
"least-negative-normalized-short-float", 134,
"least-negative-normalized-single-float", 134, "least-negative-short-float",
134, "least-negative-single-float", 134, "least-positive-double-float", 134,
"least-positive-long-float", 134, "least-positive-normalized-double-float",
134, "least-positive-normalized-long-float", 134,
"least-positive-normalized-short-float", 134,
"least-positive-normalized-single-float", 134, "least-positive-short-float",
134, "least-positive-single-float", 134, "length", 142, "let", 83, "let*", 83,
"lisp-implementation-type", 233, "lisp-implementation-version", 233, "list",
149, "list*", 149, "list-all-packages", 118, "list-length", 149, "listen",
195, "listp", 73, "load", 217, "load-logical-pathname-translations", 211,
"*load-pathname*", 217, "*load-print*", 217, "load-time-value", 224,
"*load-truename*", 217, "*load-verbose*", 217, "log", 127, "logand", 131, "logandc1", 131, "logandc2", 131, "logbitp", 131,
"logcount", 131, "logeqv", 131, "logical-pathname-translations", 211, "logior", 131, "lognand", 131,
"lognor", 131, "lognot", 131, "logorc1", 131, "logorc2", 131, "logtest", 131,
"logxor", 131, "long-float-epsilon", 134, "long-float-negative-epsilon", 134,
"long-site-name", 233, "loop", 87, "loop-finish", 245, "lower-case-p", 137,
"machine-instance", 233, "machine-type", 233, "machine-version", 233,
"macro-function", 98, "macroexpand", 99, "macroexpand-1", 99,
"*macroexpand-hook*", 99, "make-array", 158, "make-broadcast-stream", 184,
"make-char", 138, "make-concatenated-stream", 184, "make-condition", 340,
"make-dispatch-macro-character", 192, "make-echo-stream", 184,
"make-hash-table", 155, "make-instance", 311, "make-instances-obsolete", 311,
"make-list", 149, "make-load-form", 217, "make-load-form-saving-slots", 217,
"make-package", 118, "make-pathname", 214, "make-random-state", 133,
"make-sequence", 142, "make-string", 167, "make-string-input-stream", 184,
"make-string-output-stream", 184, "make-symbol", 110, "make-synonym-stream",
184, "make-two-way-stream", 184, "makunbound", 79, "map", 143, "map-fn", 351,
"map-into", 143, "mapc", 90, "mapcan", 90, "mapcar", 90, "mapcon", 90,
"maphash", 155, "mapl", 90, "maplist", 90, "mapping", 351, "mask", 353,
"mask-field", 132, "max", 124, "maximize", 246, "maximizing", 246, "member",
152, "member-if", 152, "member-if-not", 152, "merge", 146, "merge-pathnames",
214, "method-combination-error", 311, "method-qualifiers", 311, "min", 124,
"mingle", 353, "minimize", 246, "minimizing", 246, "minusp", 123, "mismatch",
145, "mod", 130, "*modules*", 119, "most-negative-double-float", 134,
"most-negative-fixnum", 134, "most-negative-long-float", 134,
"most-negative-short-float", 134, "most-negative-single-float", 134,
"most-positive-double-float", 134, "most-positive-fixnum", 134,
"most-positive-long-float", 134, "most-positive-short-float", 134,
"most-positive-single-float", 134, "muffle-warning", 344,
"multiple-value-bind", 94, "multiple-value-call", 94, "multiple-value-list",
94, "multiple-value-prog1", 94, "multiple-value-setq", 94,
"multiple-values-limit", 94, "name-char", 139, "named", 252, "namestring",
214, "nbutlast", 149, "nconcing", 246, "never",
245, "next-in", 364, "next-method-p", 311, "next-out", 365, "nil", 70,
"nintersection", 152, "ninth", 149, "no-applicable-method", 311,
"no-next-method", 311, "not", 75, "notany", 143, "notevery", 143, "nreconc",
149, "nreverse", 142, "nset-difference", 152, "nset-exclusive-or", 152,
"nstring-capitalize", 167, "nstring-downcase", 167, "nstring-upcase", 167,
"nsublis", 151, "nsubst", 151, "nsubst-if", 151, "nsubst-if-not", 151,
"nsubstitute", 144, "nsubstitute-if", 144, "nsubstitute-if-not", 144, "nth",
149, "nth-value", 94, "nthcdr", 149, "null", 73, "numberp", 73, "numerator",
130, "nunion", 152, "oddp", 123, "off-line-port", 359, "open", 215,
"open-stream-p", 185, "optimizable-series-function", 359, "or", 75,
"output-stream-p", 185, "*package*", 118, "package-error", 346,
"package-error-package", 346, "package-name", 118, "package-nicknames", 118,
"package-shadowing-symbols", 118, "package-use-list", 118,
"package-used-by-list", 118, "packagep", 73, "pairlis", 153, "parse-integer",
195, "parse-macro", 102, "parse-namestring", 214, "pathname", 214,
"pathname-device", 214, "pathname-directory", 214, "pathname-host", 214,
"pathname-match-p", 207, "pathname-name", 214, "pathname-type", 214,
"pathname-version", 214, "pathnamep", 214, "peek-char", 195, "phase", 128,
"pi", 128, "plusp", 123, "pop", 149, "position", 145, "position-if", 145,
"position-if-not", 145, "positions", 353, "pprint-dispatch", 259,
"pprint-exit-if-list-exhausted", 256, "pprint-fill", 256, "pprint-indent",
256, "pprint-linear", 256, "pprint-logical-block", 256, "pprint-newline", 256,
"pprint-pop", 256, "pprint-tab", 256, "pprint-tabular", 256, "previous", 352,
"prin1", 198, "*print-array*", 193, "*print-base*", 193, "*print-case*", 193,
"*print-circle*", 193, "*print-escape*", 193, "*print-gensym*", 193,
"*print-length*", 193, "*print-level*", 193, "*print-lines*", 255,
"*print-miser-width*", 255, "print-object", 311, "*print-pprint-dispatch*",
255, "*print-pretty*", 193, "*print-radix*", 193, "*print-readably*", 193,
"*print-right-margin*", 255, "print-unreadable-object", 198, "probe-file",
216, "proclaim", 104, "producing", 361, "prog", 91, "prog*", 91, "prog1", 82,
"prog2", 82, "progn", 82, "program-error", 346, "progv", 83,
"propagate-alterability", 361, "provide", 119, "psetf", 80, "psetq", 79,
"push", 149, "pushnew", 149, "*query-io*", 183, "quote", 78, "random", 133,
"*random-state*", 133, "random-state-p", 133, "rassoc", 153, "rassoc-if", 153,
"rassoc-if-not", 153, "rational", 130, "rationalize", 130, "rationalp", 73,
"read", 195, "*read-base*", 189, "read-byte", 196, "read-char", 195,
"read-char-no-hang", 195, "*read-default-float-format*", 195,
"read-delimited-list", 195, "*read-eval*", 189, "read-from-string", 195,
"read-line", 195, "read-preserving-whitespace", 195, "*read-suppress*", 189,
"*readtable*", 192, "readtable-case", 192, "readtablep", 192, "realp", 73,
"realpart", 130, "reduce", 143, "reinitialize-instance", 311, "rem", 130,
"remf", 108, "remhash", 155, "remove", 144, "remove-duplicates", 144,
"remove-method", 311, "remprop", 108, "rename-file", 216, "rename-package",
118, "repeat", 244, "replace", 144, "require", 119, "rest", 149, "restart",
346, "restart-bind", 341, "restart-case", 341, "restart-name", 342,
"result-of", 365, "return-from", 85, "revappend",
149, "reverse", 142, "room", 230, "rotatef", 80, "round", 130,
"row-major-aref", 160, "rplaca", 150, "rplacd", 150, "sbit", 161,
"scale-float", 130, "scan", 350, "scan-alist", 350, "scan-file", 350,
"scan-fn", 350, "scan-fn-inclusive", 350, "scan-hash", 350,
"scan-lists-of-lists", 350, "scan-lists-of-lists-fringe", 350,
"scan-multiple", 350, "scan-plist", 350, "scan-range", 350, "scan-sublists",
350, "scan-symbols", 350, "schar", 165, "search", 145, "second", 149,
"series-element-type", 360, "serious-condition",
346, "set", 79, "set-char-bit", 140, "set-difference", 152,
"set-dispatch-macro-character", 192, "set-exclusive-or", 152,
"set-macro-character", 192, "set-pprint-dispatch", 259,
"set-syntax-from-char", 192, "setf", 80, "setq", 79, "seventh", 149, "shadow",
118, "shadowing-import", 118, "shared-initialize", 311, "shiftf", 80,
"short-float-epsilon", 134, "short-float-negative-epsilon", 134,
"short-site-name", 233, "signal", 335, "signum", 128, "simple-bit-vector-p",
73, "simple-condition", 346, "simple-condition-format-arguments", 346,
"simple-condition-format-string", 346, "simple-error", 346, "simple-string-p",
73, "simple-type-error", 346, "simple-vector-p", 73, "simple-warning", 346,
"sin", 128, "single-float-epsilon", 134, "single-float-negative-epsilon", 134,
"sinh", 128, "sixth", 149, "sleep", 232, "slot-boundp", 311, "slot-exists-p",
311, "slot-makunbound", 311, "slot-missing", 311, "slot-unbound", 311,
"slot-value", 311, "software-type", 233, "software-version", 233, "some", 143,
"sort", 146, "special-form-p", 78, "split", 353, "split-if", 353, "sqrt", 127,
"stable-sort", 146, "standard-char-p", 137, "*standard-input*", 183,
"*standard-output*", 183, "step", 230, "storage-condition", 346,
"store-value", 344, "stream-element-type", 185, "stream-error", 346,
"stream-error-stream", 346, "stream-external-format", 185, "streamp", 185,
"string", 167, "string-capitalize", 167, "string-char-p", 137,
"string-downcase", 167, "string-equal", 166, "string-greaterp", 166,
"string-left-trim", 167, "string-lessp", 166, "string-not-equal", 166,
"string-not-greaterp", 166, "string-not-lessp", 166, "string-right-trim", 167,
"string-trim", 167, "string-upcase", 167, "string/=", 166, "string<", 166,
"string<=", 166, "string=", 166, "string>", 166, "string>=", 166, "stringp",
73, "sublis", 151, "subseq", 142, "subseries", 353, "subsetp", 152, "subst",
151, "subst-if", 151, "subst-if-not", 151, "substitute", 144, "substitute-if",
144, "substitute-if-not", 144, "subtypep", 72, "sum", 246, "summing", 246,
"*suppress-series-warnings*", 357, "svref", 159, "sxhash", 156,
"symbol-function", 78, "symbol-macrolet", 83, "symbol-name", 109,
"symbol-package", 110, "symbol-plist", 108, "symbol-value", 78, "symbolp", 73,
"synonym-stream-symbol", 185, "t", 70, "tagbody", 91, "tailp", 152, "tan",
128, "tanh", 128, "tenth", 149, "*terminal-io*", 183, "terminate-producing",
361, "terpri", 198, "the", 106, "thereis", 245, "third", 149, "throw", 96,
"time", 230, "to-alter", 355, "trace", 230, "*trace-output*", 183,
"translate-logical-pathname", 211, "translate-pathname", 207, "tree-equal",
148, "truename", 214, "truncate", 130, "two-way-stream-input-stream", 185,
"two-way-stream-output-stream", 185, "type-error", 346, "type-error-datum",
346, "type-error-expected-type", 346, "type-of", 53, "typecase", 84, "typep",
72, "unbound-variable", 346, "undefined-function", 346, "unexport", 118,
"unintern", 118, "union", 152, "unread-char",
195, "until-if", 352, "untrace", 230,
"unuse-package", 118, "unwind-protect", 96,
"update-instance-for-different-class", 311,
"update-instance-for-redefined-class", 311, "upgraded-array-element-type", 54,
"upgraded-complex-part-type", 54, "upper-case-p", 137, "use-package", 118,
"use-value", 344, "user-homedir-pathname", 214, "values", 94, "values-list",
94, "variable-information", 102, "vector", 158, "vector-pop", 162,
"vector-push", 162, "vector-push-extend", 162, "vectorp", 73, "warning", 346, "while", 245,
"wild-pathname-p", 207, "with", 247, "with-accessors", 311,
"with-added-methods", 311, "with-compilation-unit", 224,
"with-condition-restarts", 341, "with-hash-table-iterator", 155,
"with-input-from-string", 184, "with-open-file", 215, "with-open-stream", 184,
"with-output-to-string", 184, "with-package-iterator", 118,
"with-simple-restart", 341, "with-slots", 311, "with-standard-io-syntax", 193,
"write", 198, "write-byte", 199, "write-char", 198, "write-string", 198,
"write-to-string", 198, "y-or-n-p", 201, "yes-or-no-p", 201, "zerop", 123 );

my %ambiguous_entries = (
    "*"                => [ 125, 181 ],
    "+"                => [ 125, 181 ],
    "-"                => [ 125, 181 ],
    "/"                => [ 125, 181 ],
    "append"           => [ 149, 246 ],
    "assert"           => [ 221, 336 ],
    "break"            => [ 220, 345 ],
    "ccase"            => [ 222, 337 ],
    "cerror"           => [ 220, 335 ],
    "check-type"       => [ 221, 336 ],
    "collect"          => [ 246, 354 ],
    "compiler-let"     => [ 83,  83 ],
    "count"            => [ 145, 246 ],
    "ctypecase"        => [ 222, 337 ],
    "do"               => [ 88,  249 ],
    "documentation"    => [ 229, 311 ],
    "ecase"            => [ 222, 337 ],
    "error"            => [ 220, 335 ],
    "etypecase"        => [ 222, 337 ],
    "if"               => [ 84,  248 ],
    "in-package"       => [ 118, 118 ],
    "locally"          => [ 104, 104 ],
    "logical-pathname" => [ 208, 211 ],
    "nconc"            => [ 149, 246 ],
    "return"           => [ 85,  249 ],
    "series"           => [ 349, 349 ],
    "unless"           => [ 84,  248 ],
    "until"            => [ 245, 352 ],
    "warn"             => [ 220, 343 ],
    "when"             => [ 84,  248 ]
);

our $only_path = grep /--path/, @ARGV;
our $local_copy = grep /--local/, @ARGV;

foreach (@ARGV) {
	if ( my $node = $map{$_} ) {
        &open_node($node);
    }
    else {
        if ( $ambiguous_entries{$_} ) {
			my @nodes = @{ $ambiguous_entries{$_} };
            foreach (@nodes) {
                &open_node($_);
            }
        }
    }
}

sub open_node {
    ( my $node ) = @_;
    if ($only_path) {
		if ($local_copy) {
			print "$ENV{'HOME'}/.cl/doc/cltl2/clm/node$node.html\n";
		} else {
			print "http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node$node.html\n";
		}
    }
    else {
        if ($local_copy) {
			system("open \"$ENV{'HOME'}/.cl/doc/cltl2/clm/node$node.html\"");
		} else {
			system("open \"http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node$node.html\"");
		}
    }
}